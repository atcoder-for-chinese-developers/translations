---
title: "ABC277_G_translation"
tags: [ "概率论", "DP","数学" ]
author: "houzhiyuan"
created: "2022-11-12"
---

### 题意

已知一张 $N$ 个点，$M$ 条边的简单联通无向图，对于 $i=1,2,...,M$，第 $i$ 条边连接 $u_i$ 和 $v_i$。

高桥开始在 $1$ 号点，等级为 $0$，接下来他会进行如下操作 $K$ 次。

- 首先随机选择一个与当前点相邻的点，然后走过去。
- 然后对于走到的点 $v$，进行如下操作：

  - 如果 $C_v=0$ ，高桥等级加一。
  - 如果 $C_v=1$，高桥获得 $X^2$ 元，$X$ 是当前高桥等级。

输出高桥最后期望钱数，答案对 $998244353$ 取模。

### 数据范围

- $2\le N\le 3000$
- $N-1\le M\le \min\{N(N-1)/2,3000\}$
- $1\le K\le 3000$
- $1\le u_i,v_i\le N$
- 图无重边，无自环。
- $C_i\in \{0,1\}$

---

### 输入格式

第一行三个数 $N,M,K$。

接下来 $M$ 行，每行两个数 $u_i,v_i$，表示一条边。

然后一行 $N$ 个数，第 $i$ 个数表示 $C_i$。

### 输出格式

一行一个数，表示答案。

---

### 样例输入1

```
5 4 8
4 5
2 3
2 4
1 2
0 0 1 1 0
```

### 样例输出1

```
89349064
```

### 样例解释1

如果高桥走的路线是 $1\to 2\to 4\to 5\to 4\to 2\to 1\to 2\to 3$，那么会在 $3,4$ 出得到钱，得到的钱分别为 $1^2,2^2,5^2$，总钱数为 $1+4+25=30$ 元。

---

### 样例输入2

```
8 12 20
7 6
2 6
6 4
2 1
8 5
7 2
7 5
3 7
3 5
1 8
6 3
1 4
0 0 1 1 0 0 0 0
```

### 样例输出2

```
139119094
```
